@using System.Text.Json
@using ThoughtHub.UI.BlazorWasm.Infrastructure
@using ThoughtHub.UI.BlazorWasm.Components.Framework
@using ThoughtHub.UI.BlazorWasm.Services
@inject IArticleService articleService

<HubTab Styles="@(new HubTabClassesStyles { Header = "position: sticky; top: 57px; background: #fff; z-index: 500; padding-top: 16px;" })">
    <HubTabItem HeaderText="For you">
        <InfiniteScroll ItemsProvider="GetItems">
            <ItemTemplate Context="item">
                <ArticleCard Article="item" />
            </ItemTemplate>
            <LoadingTemplate>
                <FeedSkeleton CardCount="5" />
            </LoadingTemplate>
        </InfiniteScroll>
    </HubTabItem>
    <HubTabItem HeaderText="Featured">
        <FeaturedEmpty />
    </HubTabItem>
</HubTab>

@code {
    private List<ArticleDigestModel> Articles = new();

    public int PageSize { get; set; } = 5;

    private async Task<IEnumerable<ArticleDigestModel>?> GetItems(ItemsRequest request)
    {
        return await articleService.GetFeedArticlesAsync(request.StartIndex, PageSize);
    }
}