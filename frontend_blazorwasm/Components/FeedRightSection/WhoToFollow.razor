@using ThoughtHub.Api.Models.RecommendedPublishers


<div class="fs ft fu y">
	<div class="y">
		<div class="y">

			<div class="y">
				<div class="gc y">
					<h2 class="as gd ge an gf cn">Who to follow</h2>
				</div>
			</div>

		@if (_connection is null)
		{
			@* TODO: Dsiplay skeleton *@
		}
		else
		{
			<div class="y">
				@foreach (var edge in _connection.Edges)
				{
					switch (edge.Node)
					{
						case UserPublisherModel user:
							<div class="bb n y">
								<div class="hx n o ee eg">

									<div class="o">
										<a tabindex="0" rel="noopener follow" href="" data-discover="true">
											<div class="y br">
												<img alt="@user.Name" class="y df t dc dd dg" width="32" height="32" loading="lazy" src="@user.ProfilePictureUrl">
												<div class="db t y dc dd bs ab bl kk"></div>
											</div>
										</a>

										<div class="ao ej y">
											<a class="bi aq bk ct bm at bn ae au av aw ax ay az ba" rel="noopener follow" href="/@@@user.Username" data-discover="true">
												<h2 class="as hd ge an bw kl gw gx km gz kn hb gf cn">@user.Name</h2>
											</a>
											<a class="bi aq bk ct bm at bn ae au av aw ax ay az ba" rel="noopener follow" href="" data-discover="true">
												<div class="ko y kn">
													<p class="as b ar an bw kl gw gx km gz hb ap">@user.Bio</p>
												</div>
											</a>
										</div>

									</div>

									<div class="ki kj">
										<div class="bg">
											<button style="border: 1px solid rgb(36, 36, 36);" class="oc od av o q p oe of og">
												<span class="as b ck an cn n">
													<span class="bg oh">Follow</span>
												</span>
											</button>
										</div>
									</div>

								</div>
							</div>
							break;
						case PublicationPublisherModel publication:
							<div class="bb n y">
								<div class="hx n o ee eg">
									<div class="o">
										<a href="" rel="noopener follow">
											<div class="br">
												<img alt="@publication.Name" class="dg gt y dd dc" width="32" height="32" loading="lazy" src="@publication.PublicationImageUrl"><div class="gt y dc dd bs ab db kk">
												</div>
											</div>
										</a>
										<div class="ao ej y">
											<a class="bi aq bk ct bm at bn ae au av aw ax ay az ba" href="" rel="noopener follow">
												<h2 class="as hd ge an bw kl gw gx km gz kn hb gf cn">@publication.Name</h2>
												</a>
											<div class="kp kq y">
												<p class="as b ar an cn">Publication</p>
											</div>
											<a class="bi aq bk ct bm at bn ae au av aw ax ay az ba" href="/@publication.Slug" rel="noopener follow">
												<div class="ko y kn">
													<p class="as b ar an bw kl gw gx km gz hb ap">@publication.Description</p>
												</div>
											</a>
										</div>
									</div>
									<div class="ki kj">
										<button style="border: 1px solid rgb(36, 36, 36);" class="oc od av o q p oe of og">
											<span class="as b ck an cn n"><span class="bg oh">Follow</span></span>
										</button>
									</div>
								</div>
							</div>
							break;
					}
				}
			</div>
		}
	</div>

		<div class="hm y">
			<p class="as b ck an ap">
				<a class="bi aq bk ct bm at bn ae au av aw ax ay gm" rel="noopener follow" href="/me/following/suggestions" data-discover="true">See more suggestions</a>
			</p>
		</div>

	</div>
</div>

@code {
	[Inject]
	public IHttpClientFactory ClientFactory { get; set; }
	private HttpClient httpClient;

	private RecommendedPublisherConnectionModel? _connection = null;

	protected override async Task OnInitializedAsync()
	{
		try
		{
			httpClient = ClientFactory.CreateClient("Auth");
			_connection = await httpClient.GetFromJsonAsync<RecommendedPublisherConnectionModel>("api/recommend/who-to-follow?count=3");
		}
		catch
		{
			
		}
	}
}